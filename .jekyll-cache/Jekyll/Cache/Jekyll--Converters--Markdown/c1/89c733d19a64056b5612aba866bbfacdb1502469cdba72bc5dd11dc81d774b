I"åk<p>Wordpress ì—ì„œ Jekyll ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜ ê³¼ì •ì—ì„œ ë°°ìš´ ë‚´ìš©ì„ ì´ 5 í¸ì˜ í¬ìŠ¤íŠ¸ë¡œ ì •ë¦¬í•´ ë³¸ë‹¤.</p>

<ol>
  <li><a href="/work-n-play/ë¸”ë¡œê·¸-í”Œë«í¼-ì´ì „-1-ê°œë°œìë¡œì„œì˜-ìƒˆë¡œìš´-ì‚¶">ê°œë°œìë¡œì„œì˜ ìƒˆë¡œìš´ ì‚¶</a></li>
  <li><a href="/work-n-play/ë¸”ë¡œê·¸-í”Œë«í¼-ì´ì „-2-goodbye-wordpress-hello-jekyll">Goodbye Wordpress, Hello Jekyll</a></li>
  <li><a href="/work-n-play/ë¸”ë¡œê·¸-í”Œë«í¼-ì´ì „-3-publishing">Publishing</a></li>
  <li><a href="/work-n-play/ë¸”ë¡œê·¸-í”Œë«í¼-ì´ì „-4-build-automation-with-gulp">Build Automation with Gulp</a></li>
  <li><em>Disqus &amp; Facebook</em></li>
</ol>

<p>ì§€ë‚œ 2 ì£¼ì¼ ë™ì•ˆ ì¼ì–´ë‚œ ìš°ì—¬ê³¡ì ˆë“¤ì„ ê¸°ì–µì„ ë˜ì‚´ë ¤ ìµœëŒ€í•œ ë³µê¸°í•´ ë‘ì—ˆë‹¤.</p>

<div class="spacer">â€¢ â€¢ â€¢</div>

<p>ê¸°ì¡´ Wordpress to Jekyll ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹œë¦¬ì¦ˆì— í•˜ë‚˜ì˜ í¬ìŠ¤íŠ¸ë¥¼ ë” ì¶”ê°€í•œë‹¤. ì˜¤ëŠ˜ êµ¬í˜„í•œ ë”°ëˆí•œ ê¸°ëŠ¥ 2ê°€ì§€ ì´ë‹¤.</p>

<ul>
  <li>Disqus<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote">1</a></sup> ìµœì‹  ëŒ“ê¸€ ë½‘ì•„ ì˜¤ê¸°</li>
  <li>Facebook ìµœì‹  í¬ìŠ¤íŠ¸ ë½‘ì•„ ì˜¤ê¸°</li>
</ul>

<h2 id="disqus-ìµœê·¼-ëŒ“ê¸€-ë½‘ì•„-ì˜¤ê¸°">Disqus ìµœê·¼ ëŒ“ê¸€ ë½‘ì•„ ì˜¤ê¸°</h2>

<p>Disqus ì—ì„œ ì´ë¯¸ ìœ„ì ¯ì„ ì œê³µí•˜ê³  ìˆì–´ì„œ êµ¬í˜„ì€ ì•„ì£¼ ê°„ë‹¨í•œë‹¤.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- https://github.com/appkr/blog/blob/master/_includes/site-sidebar.html#L64 --&gt;</span>

<span class="c">&lt;!-- ... --&gt;</span>
<span class="nt">&lt;section</span> <span class="na">class=</span><span class="s">"box"</span> <span class="na">id=</span><span class="s">"recent-comments"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"box-header"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;h3&gt;</span>Recent Comments<span class="nt">&lt;/h3&gt;</span>
  <span class="nt">&lt;/div&gt;</span>

  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"box-body dsq-widget"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"http://appkr.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_mods=0&amp;hide_avatars=0&amp;avatar_size=32&amp;excerpt_length=100"</span><span class="nt">&gt;&lt;/script&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/section&gt;</span>
<span class="c">&lt;!-- ... --&gt;</span>
</code></pre></div></div>

<!--more-->

<p>í•µì‹¬ì€ <code class="highlighter-rouge">&lt;script src="..."&gt;&lt;/script&gt;</code> í•œ ì¤„ì´ë‹¤. ê° ì¿¼ë¦¬ ìŠ¤íŠ¸ë§ íŒŒë¼ë¯¸í„°ì˜ ì˜ë¯¸ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.</p>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th style="text-align: right">Default</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">num_items</code></td>
      <td style="text-align: right">5</td>
      <td>ê°€ì ¸ì˜¬ ëŒ“ê¸€ ê°¯ìˆ˜ (ìµœì‹ ìˆœ)</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">hide_mods</code></td>
      <td style="text-align: right">0</td>
      <td>ê´€ë¦¬ì ëŒ“ê¸€ ìˆ¨ê¹€ ì—¬ë¶€ (<code class="highlighter-rouge">1</code> ë¡œ ì„¤ì •í•˜ë©´ ê´€ë¦¬ì ëŒ“ê¸€ì€ ë¹ ì§)</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">excerpt_length</code></td>
      <td style="text-align: right">100</td>
      <td>ì˜ë¼ë‚¼ ëŒ“ê¸€ ë³¸ë¬¸ ê¸¸ì´ (Double Byte Safe)</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">hide_avatars</code></td>
      <td style="text-align: right">0</td>
      <td>Avatar ì´ë¯¸ì§€ ìˆ¨ê¹€ ì—¬ë¶€ (<code class="highlighter-rouge">1</code> ë¡œ ì„¤ì •í•˜ë©´ Avatar ë¹ ì§)</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">avatar_size</code></td>
      <td style="text-align: right">32</td>
      <td>Avatar ì´ë¯¸ì§€ í¬ê¸°</td>
    </tr>
  </tbody>
</table>

<p>ë Œë”ë§ ëœ Markup ì€ ì•„ë˜ì™€ ê°™ë‹¤. íƒœê·¸ì™€ í´ë˜ìŠ¤ë¥¼ ì´ìš©í•˜ì—¬ ì ì ˆíˆ ìŠ¤íƒ€ì¼ë§ í•˜ì˜€ë‹¤.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"dsq-widget-list"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"dsq-widget-item"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"https://disqus.com/by/{user_id}/"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;img</span> <span class="na">class=</span><span class="s">"dsq-widget-avatar"</span> <span class="na">src=</span><span class="s">"{avatar_url}"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"dsq-widget-user"</span> <span class="na">href=</span><span class="s">"https://disqus.com/by/{user_id}/"</span><span class="nt">&gt;</span>{user_name}<span class="nt">&lt;/a&gt;</span> 
    <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"dsq-widget-comment"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;p&gt;</span>{message}<span class="nt">&lt;/p&gt;</span>
    <span class="nt">&lt;/span&gt;</span>
    <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"dsq-widget-meta"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"{post_url}"</span><span class="nt">&gt;</span>{post_title}<span class="nt">&lt;/a&gt;</span>
      <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"{post_url}/#comment-{comment_id}"</span><span class="nt">&gt;</span>{n} {minutes/hours/days/...} ago<span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;/ul&gt;</span>
</code></pre></div></div>

<h2 id="facebook-ìµœì‹ -í¬ìŠ¤íŠ¸-ë½‘ì•„-ì˜¤ê¸°">Facebook ìµœì‹  í¬ìŠ¤íŠ¸ ë½‘ì•„ ì˜¤ê¸°</h2>

<p>ëª‡ ë…„ ì „ì— Facebook ê°œë°œì ë¬¸ì„œ ë³´ë©´ì„œ í•œìˆ¨~ ì‰¬ì—ˆë˜ ê¸°ì–µì´ ìˆë‹¤. ì˜¤ëŠ˜ë„ ì‚½ì§ˆ ê½¤ë‚˜ í–ˆë‹¤. ê°€ì¥ í° ë¬¸ì œì ì€ ì°¾ê¸°ê°€ ë„ˆë¬´ í˜ë“¤ë‹¤ëŠ” ê²ƒ.</p>

<h3 id="app-registration">App Registration</h3>

<p>ë¨¼ì € <a href="https://developers.facebook.com/quickstarts/?platform=web">Facebook Developer Console</a> ì—ì„œ App ì„ ë“±ë¡í•´ì•¼ í•œë‹¤. ë“±ë¡í•˜ê³  ë°›ì€ <code class="highlighter-rouge">app_id</code>, <code class="highlighter-rouge">app_secret</code> ëŠ” ì˜ ë³´ê´€í•´ ë‘ì–´ì•¼ í•œë‹¤.</p>

<h3 id="javascript-sdk-ì„¤ì¹˜">Javascript SDK ì„¤ì¹˜</h3>

<p>SDK ë¥¼ ì„¤ì¹˜í•˜ê³  ì´ˆê¸°í™” í•´ì•¼ í•œë‹¤. App ë“±ë¡ì—ì„œ ë°›ì€ <code class="highlighter-rouge">app_id</code> ë¥¼ <code class="highlighter-rouge">facebookAppId</code> ë³€ìˆ˜ì— í• ë‹¹í•˜ì˜€ë‹¤.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// https://github.com/appkr/blog/blob/master/_assets/scripts/main.js#L271</span>

<span class="cm">/* Facebook Recent UserFeeds */</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">fbAsyncInit</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">facebookAppId</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">{app_id}</span><span class="dl">'</span><span class="p">;</span>
  <span class="nx">FB</span><span class="p">.</span><span class="nx">init</span><span class="p">({</span><span class="na">appId</span><span class="p">:</span> <span class="nx">facebookAppId</span><span class="p">,</span> <span class="na">status</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="na">xfbml</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">cookie</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="na">version</span><span class="p">:</span> <span class="dl">'</span><span class="s1">v2.5</span><span class="dl">'</span><span class="p">});</span>
<span class="p">};</span>

<span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span> <span class="nx">s</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">js</span><span class="p">,</span> <span class="nx">fjs</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="nx">s</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">id</span><span class="p">))</span> <span class="p">{</span><span class="k">return</span><span class="p">;}</span>
  <span class="nx">js</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span> <span class="nx">js</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">id</span><span class="p">;</span>
  <span class="nx">js</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">//connect.facebook.net/en_US/sdk.js</span><span class="dl">"</span><span class="p">;</span>
  <span class="nx">fjs</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">js</span><span class="p">,</span> <span class="nx">fjs</span><span class="p">);</span>
<span class="p">}(</span><span class="nb">document</span><span class="p">,</span> <span class="dl">'</span><span class="s1">script</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">facebook-jssdk</span><span class="dl">'</span><span class="p">));</span>
</code></pre></div></div>

<p>í˜ì´ì§€ ë¡œë“œí•´ì„œ ì—ëŸ¬ê°€ ì•ˆë‚¬ë‹¤. SDK ê°€ ì˜ ë¡œë“œë˜ì—ˆë‹¤ëŠ” ì˜ë¯¸ë‹¤~</p>

<h3 id="markup">Markup</h3>

<p>í‘œì‹œí•  ë·°ì˜ ë‚´ìš©ì´ ë³µì¡í•˜ì§€ë„ ì•Šì„ ë¿ë”ëŸ¬, 3rd Party Template Engine<sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote">2</a></sup> ì˜ì¡´ì„±ì„ ì œê±°í•˜ê¸° ìœ„í•´ Template ì»´íŒŒì¼ì„ ì§ì ‘ êµ¬í˜„í•˜ê¸°ë¡œ í–ˆë‹¤.</p>

<p><code class="highlighter-rouge">ul.facebook-feed</code> ì—˜ë¦¬ë¨¼íŠ¸ ì•ˆìª½ì—, Template ìœ¼ë¡œ ì“°ì¼ <code class="highlighter-rouge">script#facebook-feed-template</code> ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ìœ„ì¹˜ì‹œì¼°ë‹¤. ê·¸ë¦¬ê³ , Jekyll Liquid ì™€ ì¶©ëŒì„ í”¼í•˜ê¸° ìœ„í•´ì„œ Single Curly Brace (<code class="highlighter-rouge">{}</code>) ë¥¼ String Interpolation ê¸°í˜¸ë¡œ ì‚¬ìš©í•˜ì˜€ë‹¤. ë°”ì¸ë”©í•  ëŒ€ìƒì€ <code class="highlighter-rouge">{ message }</code>, <code class="highlighter-rouge">{ id }</code>, <code class="highlighter-rouge">{ created_time }</code> ë”± 3 ê°œ ë¿ì´ë‹¤.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- https://github.com/appkr/blog/blob/master/_includes/site-sidebar.html#L74 --&gt;</span>

<span class="nt">&lt;section</span> <span class="na">class=</span><span class="s">"box"</span> <span class="na">id=</span><span class="s">"recent-feeds"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"box-header"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;h3&gt;</span>Facebook Posts<span class="nt">&lt;/h3&gt;</span>
  <span class="nt">&lt;/div&gt;</span>

  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"box-body"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ul</span> <span class="na">id=</span><span class="s">"facebook-feed"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;script </span><span class="na">id=</span><span class="s">"facebook-feed-template"</span> <span class="na">type=</span><span class="s">"text/x-template"</span><span class="nt">&gt;</span>
        <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">span</span> <span class="kd">class</span><span class="o">=</span><span class="dl">"</span><span class="s2">facebook-message</span><span class="dl">"</span><span class="o">&gt;</span>
            <span class="p">{</span> <span class="nx">message</span> <span class="p">}</span>
          <span class="o">&lt;</span><span class="sr">/span</span><span class="err">&gt;
</span>          <span class="err">Â·</span>
          <span class="o">&lt;</span><span class="nx">span</span> <span class="kd">class</span><span class="o">=</span><span class="dl">"</span><span class="s2">facebook-meta</span><span class="dl">"</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="dl">"</span><span class="s2">https://www.facebook.com/juwonkimatmedotcom/posts/{ id }</span><span class="dl">"</span><span class="o">&gt;</span>
              <span class="p">{</span> <span class="nx">created_time</span> <span class="p">}</span>
            <span class="o">&lt;</span><span class="sr">/a</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="sr">/span</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="sr">/li</span><span class="err">&gt;
</span>      <span class="nt">&lt;/script&gt;</span>
    <span class="nt">&lt;/ul&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/section&gt;</span>
</code></pre></div></div>

<h3 id="template-compile--rendering">Template Compile &amp; Rendering</h3>

<p><a href="https://developers.facebook.com/docs/graph-api">Facebook Graph API</a> ë¥¼ ì´ìš©í•˜ë©´ ë‚´ Facebook ê³„ì •ì˜ í¬ìŠ¤íŠ¸ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤. ë‹¤ë§Œ, ìµœê·¼ API ì—ì„œëŠ” <code class="highlighter-rouge">GET</code> ìš”ì²­ì—ë„ ì¸ì¦ì´ í•„ìš”í•œ ê²ƒ ê°™ë‹¤. ì—¬ê¸°ì„œ ê½¤ ì˜¤ëœ ì‚½ì§ˆì„ í–ˆë‹¤.</p>

<p>Oauth ì¸ì¦ UI ë° í”„ë¡œì„¸ìŠ¤ë¥¼ ì§ì ‘ êµ¬í˜„í•˜ëŠ” ê²ƒì„ í”¼í•˜ê¸° ìœ„í•´, CURL ì„ ì´ìš©í•˜ì˜€ë‹¤.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="s2">"https://graph.facebook.com/oauth/access_token?client_id={app_id}&amp;client_secret={app_secret}&amp;grant_type=client_credentials&amp;scope=user_posts"</span>
<span class="c"># access_token=xxxxxxxxxxxxxxxxxxxxxxxxx...</span>
</code></pre></div></div>

<p>ì—¬ê¸°ì„œ ë°›ì€ <code class="highlighter-rouge">access_token</code> ì€ 1 ì‹œê°„ ì§œë¦¬ì´ë‹¤. Facebook ê³µì‹ ìš©ì–´ë¡œëŠ” Long Lived Token ì´ë¼ í•˜ëŠ”ë°, 60 ì¼ ì§œë¦¬ í† í°ìœ¼ë¡œ êµí™˜í•´ì•¼ í•œë‹¤.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="s2">"https://graph.facebook.com/oauth/access_token?grant_type=fb_exchange_token&amp;client_id={app_id}&amp;client_secret={app_secret}&amp;fb_exchange_token={access_token}"</span>
<span class="c"># access_token=yyyyyyyyyyyyyyyyyyyyyyyyy...</span>
</code></pre></div></div>

<p>60 ì¼ ì§œë¦¬ <code class="highlighter-rouge">access_token</code> ì´ í™•ë³´ë˜ì—ˆë‹¤. API ë¥¼ í˜¸ì¶œí•˜ë©´ ë˜ëŠ”ë°â€¦</p>

<p>Javascript ì—ì„œëŠ” ì½”ë“œ ë‚´ì— í¬í•¨ëœ <code class="highlighter-rouge">access_token</code> ì´ ê³µê°œë˜ë¯€ë¡œ ë³´ì•ˆìƒ ì•„ì£¼ ìœ„í—˜í•˜ë‹¤. Javascript ë¥¼ ë²—ì–´ ë‚˜ì§€ ì•Šê³  ì´ë¥¼ ê°ì¶œ ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì°¾ì•„ í—¤ë©¨ì§€ë§Œ, ê²°ë¡ ì€ â€œê·¸ëŸ° ë°©ë²•ì€ ì—†ë‹¤â€ ì˜€ë‹¤. í˜„ì¬ê¹Œì§€ ì¡°ì‚¬í•œ ë°”ë¡œëŠ” ìì²´ ë°±ì—”ë“œ ì„œë²„ ì—†ì´ëŠ” ë¶ˆê°€í•˜ë‹¤ê³  ì•Œë ¤ì ¸ ìˆëŠ”ë°â€¦ ì¼ë‹¨ ë³´ì•ˆì„ ì¢€ í¬ìƒí•˜ë©´ì„œ, êµ¬í˜„ì— ì§‘ì¤‘í•˜ê¸°ë¡œ í•œë‹¤.</p>

<p>ë¬¸ì„œë¥¼ ë³´ê³  <code class="highlighter-rouge">me/posts</code> ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì´ìš©í•˜ë©´ ëœë‹¤ëŠ” ê²ƒì„ ì•Œì•˜ë‹¤. <code class="highlighter-rouge">me/posts</code> API í˜¸ì¶œ ê²°ê³¼ì—ì„œ <code class="highlighter-rouge">response.data</code> ì†ì„±ì´ í¬ìŠ¤íŠ¸ë“¤ì„ ë‹´ê³  ìˆëŠ” Collection ì´ë‹¤. <code class="highlighter-rouge">markup</code> ë³€ìˆ˜ëŠ” <code class="highlighter-rouge">compile()</code> Helper ì— ì˜í•´ ì»´íŒŒì¼ëœ <code class="highlighter-rouge">li</code> ì—˜ë¦¬ë¨¼íŠ¸ê°€ í¬í•¨ëœ HTML ì´ë©°, ì´ HTML ì„ <code class="highlighter-rouge">ul#facebook-feed</code> ì— ë¶™ì—¬ DOM ì„ ì—…ë°ì´íŠ¸í•˜ì˜€ë‹¤. (í™”ë©´ì´ ë¡œë“œë˜ê³  í•œì°¸ ìˆë‹¤ ëœ¬ë‹¤~ jQuery ë¥¼ ì“°ë©´ ì•ˆë˜ëŠ” ì´ìœ ;;)</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// https://github.com/appkr/blog/blob/master/_assets/scripts/main.js#L291</span>

<span class="nb">window</span><span class="p">.</span><span class="nx">fbAsyncInit</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">facebookAccessToken</span> <span class="o">=</span>  <span class="dl">'</span><span class="s1">{access_token}</span><span class="dl">'</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">facebookAppId</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">{app_id}</span><span class="dl">'</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">facebookFeedContainer</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">ul#facebook-feed</span><span class="dl">'</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">facebookFeedTemplate</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">#facebook-feed-template</span><span class="dl">'</span><span class="p">).</span><span class="nx">html</span><span class="p">());</span>

  <span class="nx">FB</span><span class="p">.</span><span class="nx">init</span><span class="p">({</span><span class="na">appId</span><span class="p">:</span> <span class="nx">facebookAppId</span><span class="p">,</span> <span class="na">status</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="na">xfbml</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">cookie</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="na">version</span><span class="p">:</span> <span class="dl">'</span><span class="s1">v2.5</span><span class="dl">'</span><span class="p">});</span>

  <span class="nx">FB</span><span class="p">.</span><span class="nx">api</span><span class="p">(</span><span class="dl">'</span><span class="s1">me/posts</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">GET</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span><span class="na">limit</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="na">access_token</span><span class="p">:</span> <span class="nx">facebookAccessToken</span><span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="nx">response</span> <span class="o">||</span> <span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">facebookFeedContainer</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="dl">'</span><span class="s1">&lt;li&gt;Some error :(&lt;/li&gt;</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">markup</span> <span class="o">=</span> <span class="nx">compile</span><span class="p">(</span><span class="nx">facebookFeedTemplate</span><span class="p">,</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
    <span class="nx">facebookFeedContainer</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">markup</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">};</span>
</code></pre></div></div>

<p>ì•„ë˜ëŠ” <code class="highlighter-rouge">compile()</code>, <code class="highlighter-rouge">truncate()</code> Helper ì´ë‹¤. ë„˜ê²¨ ë°›ì€ <code class="highlighter-rouge">facebookUserFeedCollection</code> ë°°ì—´ì„ ìˆœíšŒí•˜ë©´ì„œ Regex ë¡œ <code class="highlighter-rouge">{}</code> ë¥¼ ì°¾ì€ í›„, ë°°ì—´ ì•„ì´í…œì˜ ê°’ì„ ë°”ì¸ë”©ì‹œí‚¤ëŠ” ì‹ìœ¼ë¡œ Template ì„ HTML ë¡œ ì»´íŒŒì¼í•˜ì˜€ë‹¤.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// https://github.com/appkr/blog/blob/master/_assets/scripts/main.js#L263</span>

<span class="kd">var</span> <span class="nx">compile</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">layoutTemplate</span><span class="p">,</span> <span class="nx">facebookUserFeedCollection</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">markup</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>

  <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">facebookUserFeedCollection</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">markup</span> <span class="o">+=</span> <span class="nx">layoutTemplate</span>
      <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/{</span><span class="se">\s?</span><span class="sr">id</span><span class="se">\s?</span><span class="sr">}/ig</span><span class="p">,</span> <span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="s1">_</span><span class="dl">'</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
      <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/{</span><span class="se">\s?</span><span class="sr">message</span><span class="se">\s?</span><span class="sr">}/ig</span><span class="p">,</span> <span class="nx">truncate</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">message</span> <span class="o">||</span> <span class="nx">item</span><span class="p">.</span><span class="nx">story</span><span class="p">))</span>
      <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/{</span><span class="se">\s?</span><span class="sr">created_time</span><span class="se">\s?</span><span class="sr">}/ig</span><span class="p">,</span> <span class="nx">moment</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">created_time</span><span class="p">,</span> <span class="nx">moment</span><span class="p">.</span><span class="nx">ISO_8601</span><span class="p">).</span><span class="nx">fromNow</span><span class="p">());</span>
  <span class="p">});</span>

  <span class="k">return</span> <span class="nx">markup</span><span class="p">;</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">truncate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">len</span> <span class="o">||</span> <span class="mi">100</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">str</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">str</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">...</span><span class="dl">'</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">str</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div></div>

<p>íœ´~</p>

<p>Disqus ì™€ ë™ì¼í•œ <em><code class="highlighter-rouge">{n} {minutes/hours/days/...} ago</code></em> í˜•ì‹ì˜ ë‚ ì§œë¡œ í¬ë§·íŒ…í•˜ê¸° ìœ„í•´ <code class="highlighter-rouge">moment</code> íŒ¨í‚¤ì§€ë¥¼ ê°€ì ¸ì™”ê³ , <code class="highlighter-rouge">moment('2016-02-12T09:00:00+0000', moment.ISO_8601).fromNow())</code> ì²˜ëŸ¼ ì‚¬ìš©í•˜ì˜€ë‹¤.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>bower <span class="nb">install </span>moment <span class="nt">--save-dev</span>
</code></pre></div></div>

<div class="spacer">â€¢ â€¢ â€¢</div>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1" role="doc-endnote">
      <p><a href="https://disqus.com/">Disqus</a> ëŠ” ëŒ“ê¸€ ì„œë¹„ìŠ¤ ì´ë‹¤. Jekyll ì€ ëª¨ë“  ë©´ì—ì„œ ë‚´ê°€ ì›í•˜ëŠ” ê²ƒë“¤ì„ ì¶©ì¡±í•´ ì£¼ì—ˆì§€ë§Œ, ê°€ì¥ ì•„ì‰¬ìš´ ì  ì¤‘ì— í•˜ë‚˜ê°€ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ì— ëŒ€í•œ ëŒ“ê¸€ì´ì—ˆë‹¤. ëŒ“ê¸€ì˜ íŠ¹ì„±ìƒ ë¸”ë¡œê·¸ ë°©ë¬¸ìì™€ ê³„ì† ì¸í„°ë™ì…˜í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ëŒ“ê¸€ì„ ì €ì¥í•  ë°±ì—”ë“œê°€ ë°˜ë“œì‹œ í•„ìš”í•œë°â€¦ ì´ ë•Œ ì„ íƒí•  ìˆ˜ ìˆëŠ” ì˜µì…˜ì´ Disqus ì™€ ê°™ì€ ì™¸ë¶€ ëŒ“ê¸€ ì„œë¹„ìŠ¤ì´ë‹¤. ìœ ì‚¬ ì„œë¹„ìŠ¤ë¡œëŠ” <a href="https://www.livere.com/">Livere-êµ­ì‚°</a>, <a href="//chak.it/">Chak-êµ­ì‚°</a> ë“±ì´ ìˆë‹¤.Â <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:2" role="doc-endnote">
      <p>Javascript Template Engine ìœ¼ë¡œëŠ” <a href="//handlebarsjs.com/">Handlebars</a>ê°€ ì „í†µì  ê°•ìì´ë‹¤. <a href="http://ejs.co/">EJS</a> ë„ ê½¤ ì“°ì´ëŠ” ê²ƒ ê°™ë‹¤. ê´€ë ¨í•´ì„œ <a href="http://www.sitepoint.com/overview-javascript-templating-engines/">SitePoint ì—ì„œ í›Œë¥­í•œ ì•„í‹°í´</a>ì„ ì¼ë‹¤.Â <a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>
:ET